<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>文本替换工具</title>
<style>
  body {
    font-family: Arial, sans-serif;
  }
  textarea {
    width: 100%;
    height: 150px;
  }
  #output {
    margin-top: 10px;
    border: 1px solid #ccc;
    padding: 10px;
    white-space: pre-line;
  }
  .highlight {
    background-color: yellow;
    font-weight: bold;
  }
</style>
</head>
<body>
<h1>文本替换工具</h1>
<label for="input">输入文本段落:</label>
<textarea id="input" oninput="applyReplacements()"></textarea>

<div id="replaceRules">
  <div class="replaceRule">
    <label for="find1">待替换文本 1:</label>
    <input type="text" class="find" id="find1" oninput="applyReplacements()">
    <label for="replace1">替换后文本 1:</label>
    <input type="text" class="replace" id="replace1" oninput="applyReplacements()">
  </div>
</div>

<button onclick="addReplaceRule()">增加替换文本</button>
<button onclick="copyOutput()">一键复制</button>

<div id="output"></div>

<script>
function addReplaceRule() {
  const replaceRulesDiv = document.getElementById("replaceRules");
  const newReplaceRuleDiv = document.createElement("div");
  const ruleIndex = replaceRulesDiv.children.length + 1;

  newReplaceRuleDiv.className = "replaceRule";
  newReplaceRuleDiv.innerHTML = `
    <label for="find${ruleIndex}">待替换文本 ${ruleIndex}:</label>
    <input type="text" class="find" id="find${ruleIndex}" oninput="applyReplacements()">
    <label for="replace${ruleIndex}">替换后文本 ${ruleIndex}:</label>
    <input type="text" class="replace" id="replace${ruleIndex}" oninput="applyReplacements()">
  `;

  replaceRulesDiv.appendChild(newReplaceRuleDiv);
}

function applyReplacements() {
  const inputText = document.getElementById("input").value;
  const replaceRules = document.querySelectorAll(".replaceRule");

  let outputText = inputText;

  replaceRules.forEach((rule, index) => {
    const findInput = rule.querySelector(`#find${index + 1}`);
    const replaceInput = rule.querySelector(`#replace${index + 1}`);

    if (findInput && replaceInput) {
      const find = findInput.value;
      const replace = replaceInput.value;

      if (find !== "" && replace !== "") {
        const regex = new RegExp(find, "g");
        outputText = outputText.replace(regex, match => `<span class="highlight">${replace}</span>`);
      }
    }
  });

  document.getElementById("output").innerHTML = outputText;
}


function copyOutput() {
  const outputText = document.getElementById("output").innerText;
  const tempTextArea = document.createElement("textarea");
  tempTextArea.value = outputText;
  document.body.appendChild(tempTextArea);
  tempTextArea.select();
  document.execCommand("copy");
  document.body.removeChild(tempTextArea);
  alert("已复制到剪贴板！");
}
</script>
</body>
</html>
